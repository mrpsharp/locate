window.os=window.os||{},os.Transform={_maxBounds:{projected:[[0,0],[699999.9,1299999.9]],geographic:[[-8.74,49.84],[1.96,60.9]]},_checkBounds:function(e){var o=!0,e=(e.hasOwnProperty("ea")&&e.hasOwnProperty("no")?(e.ea<this._maxBounds.projected[0][0]||e.ea>this._maxBounds.projected[1][0]||e.no<this._maxBounds.projected[0][1]||e.no>this._maxBounds.projected[1][1])&&(o=!1):e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")&&(e.lng<this._maxBounds.geographic[0][0]||e.lng>this._maxBounds.geographic[1][0]||e.lat<this._maxBounds.geographic[0][1]||e.lat>this._maxBounds.geographic[1][1])&&(o=!1),o?"":"Coordinates out of range.");return{valid:o,message:e}},_validateGridRef:function(e){var o=!!Array.isArray(e.toUpperCase().match(/^[THJONS][VWXYZQRSTULMNOPFGHJKABCDE] ?[0-9]{1,5} ?[0-9]{1,5}$/)),e=e.replaceAll(" ","").length%2==0&&o;return{valid:e,message:e?"":"Invalid grid reference."}},toLatLng:function(e,o=7){var t,r=this._checkBounds(e);return r.valid?(e=proj4("EPSG:27700","EPSG:4326",[e.ea,e.no]),t=Number(e[0].toFixed(o)),{lat:Number(e[1].toFixed(o)),lng:t}):(console.log(r.message),{})},fromLatLng:function(e,o=2){var t=this._checkBounds(e);return t.valid?(e=proj4("EPSG:4326","EPSG:27700",[e.lng,e.lat]),{ea:Number(e[0].toFixed(o)),no:Number(e[1].toFixed(o))}):(console.log(t.message),{})},toGridRef:function(e){var o,t,r=this._checkBounds(e);return r.valid?(o=Math.floor(e.ea/1e5),o=[["SV","SW","SX","SY","SZ","TV","TW"],["SQ","SR","SS","ST","SU","TQ","TR"],["SL","SM","SN","SO","SP","TL","TM"],["SF","SG","SH","SJ","SK","TF","TG"],["SA","SB","SC","SD","SE","TA","TB"],["NV","NW","NX","NY","NZ","OV","OW"],["NQ","NR","NS","NT","NU","OQ","OR"],["NL","NM","NN","NO","NP","OL","OM"],["NF","NG","NH","NJ","NK","OF","OG"],["NA","NB","NC","ND","NE","OA","OB"],["HV","HW","HX","HY","HZ","JV","JW"],["HQ","HR","HS","HT","HU","JQ","JR"],["HL","HM","HN","HO","HP","JL","JM"]][Math.floor(e.no/1e5)][o],t=Math.floor(e.ea%1e5),e=Math.floor(e.no%1e5),{text:o+" "+(t=String(t).padStart(5,"0"))+" "+(e=String(e).padStart(5,"0")),html:o+"&thinsp;"+t+"&thinsp;"+e,letters:o,eastings:t,northings:e}):(console.log(r.message),{})},fromGridRef:function(e){e=String(e).trim();var o,t,r,a,n,s,i=this._validateGridRef(e);return i.valid?(a="VWXYZQRSTULMNOPFGHJKABCDE",e=e.toUpperCase().replaceAll(" ",""),o=a.indexOf(e[0])%5*5e5-1e6,t=5e5*Math.floor(a.indexOf(e[0])/5)-5e5,r=a.indexOf(e[1])%5*1e5,a=1e5*Math.floor(a.indexOf(e[1])/5),n=(e.length-2)/2,s=Math.pow(10,5-n),{ea:o+r+e.substr(2,n)*s,no:t+a+e.substr(2+n,n)*s}):(console.log(i.message),{})}};